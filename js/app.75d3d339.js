(function(){"use strict";var e={2796:function(e,t,n){var r={};n.r(r),n.d(r,{createEntry:function(){return A},deleteEntry:function(){return C},loadEntries:function(){return I},updateEntry:function(){return j}});var o={};n.r(o),n.d(o,{createEntry:function(){return N},getEntriesById:function(){return U},getEntriesByTerm:function(){return O}});var a={};n.r(a),n.d(a,{addEntry:function(){return L},clearEntries:function(){return F},deleteEntry:function(){return _},setEntries:function(){return P},updateEntry:function(){return x}});var i={};n.r(i),n.d(i,{checkAuthentication:function(){return Z},createUser:function(){return q},signInUser:function(){return H}});var s={};n.r(s),n.d(s,{currentState:function(){return z},userName:function(){return V}});var u={};n.r(u),n.d(u,{loginUser:function(){return J},logout:function(){return K}});var c=n(9963),l=n(6252);function d(e,t,n,r,o,a){const i=(0,l.up)("router-view");return(0,l.wg)(),(0,l.j4)(i)}var f=n(4207),m={setup(){const{authStatus:e,checkAuthStatus:t}=(0,f.Z)();return t(),{authStatus:e}}},h=n(3744);const p=(0,h.Z)(m,[["render",d]]);var g=p,y=n(2119),v={name:"daybook",component:()=>n.e(931).then(n.bind(n,7607)),children:[{path:"",name:"no-entry",component:()=>Promise.all([n.e(455),n.e(182)]).then(n.bind(n,3760))},{path:":id",name:"entry",component:()=>Promise.all([n.e(455),n.e(182)]).then(n.bind(n,357)),props:e=>({id:e.params.id})}]},k={name:"auth",component:()=>Promise.all([n.e(455),n.e(888)]).then(n.bind(n,5987)),children:[{path:"",name:"login",component:()=>Promise.all([n.e(455),n.e(888)]).then(n.bind(n,6243))},{path:"/register",name:"register",component:()=>Promise.all([n.e(455),n.e(888)]).then(n.bind(n,4179))}]},b=n(3907),T=n(9669),w=n.n(T);const E=w().create({baseURL:"https://journal-vue-52048-default-rtdb.firebaseio.com"});E.interceptors.request.use((e=>(e.params={auth:localStorage.getItem("idToken")},e)));var S=E;const I=async({commit:e})=>{const{data:t}=await S.get(`/entries/${localStorage.getItem("localId")}.json`);if(!t)return void e("setEntries",[]);const n=[];for(let r of Object.keys(t))n.push({id:r,...t[r]});e("setEntries",n)},j=async({commit:e},{date:t,text:n,picture:r,id:o})=>{const{data:a}=await S.put(`/entries/${localStorage.getItem("localId")}/${o}.json`,{date:t,text:n,picture:r});e("updateEntry",{id:o,...a})},A=async({commit:e},t)=>{const n={...t},{data:{name:r}}=await S.post(`/entries/${localStorage.getItem("localId")}.json`,n);return e("addEntry",{id:r,...n}),r},C=async({commit:e},t)=>{await S["delete"](`/entries/${localStorage.getItem("localId")}/${t}.json`),e("deleteEntry",t)},O=e=>(t="")=>0===t.length?e.entries:e.entries.filter((e=>e.text.toLowerCase().includes(t.toLocaleLowerCase()))),U=e=>(t="")=>{const n=e.entries.find((e=>e.id===t));if(n)return{...n}},N=()=>{},P=(e,t)=>{e.entries=[...e.entries,...t],e.isLoading=!1},x=(e,t)=>{const n=e.entries.findIndex((({id:e})=>t.id===e));e.entries[n]=t},L=(e,t)=>{e.entries.unshift(t)},_=(e,t)=>{const n=e.entries.findIndex((e=>t===e.id));e.entries.splice(n,1)},F=e=>{e.entries=[]};var R=()=>({isLoading:!0,entries:[]});const $={namespaced:!0,actions:r,getters:o,mutations:a,state:R};var B=$;const D=w().create({baseURL:"https://identitytoolkit.googleapis.com/v1/accounts",params:{key:"AIzaSyCh82f7hVgojmDt5mEn_HEDY2bhzwR7Vs0"}});var M=D;const q=async({commit:e},t)=>{const{name:n,email:r,pswrd:o}=t;try{const{data:a}=await M.post(":signUp",{email:r,password:o,returnSecureToken:!0}),{idToken:i,refreshToken:s,localId:u}=a;return await M.post(":update",{displayName:n,idToken:i}),delete t.pswrd,e("loginUser",{user:t,idToken:i,refreshToken:s,localId:u}),{ok:!0,message:"USER-CREATED"}}catch(a){return{ok:!1,message:a.response.data.error.message}}},H=async({commit:e},t)=>{const{email:n,pswrd:r}=t;try{const{data:o}=await M.post(":signInWithPassword",{email:n,password:r,returnSecureToken:!0}),{displayName:a,idToken:i,refreshToken:s,localId:u}=o;return delete t.pswrd,t.name=a,e("loginUser",{user:t,idToken:i,refreshToken:s,localId:u}),{ok:!0,message:" "}}catch(o){return{ok:!1,message:o.response.data.error.message}}},Z=async({commit:e})=>{const t=localStorage.getItem("idToken"),n=localStorage.getItem("refreshToken");if(!t)return e("logout"),{ok:!1,message:"No hay token en la peticion"};try{const{data:r}=await M.post(":lookup",{idToken:t}),{displayName:o,email:a}=r.users[0],i={name:o,email:a};return e("loginUser",{user:i,idToken:t,refreshToken:n}),{ok:!0,message:""}}catch(r){return e("logout"),{ok:!1,message:r.response.data.message}}},z=e=>e.status,V=e=>e.user?.name||"",J=(e,{user:t,idToken:n,refreshToken:r,localId:o})=>{n&&(localStorage.setItem("idToken",n),e.idToken=n),r&&(localStorage.setItem("refreshToken",r),e.refreshToken=r),o&&localStorage.setItem("localId",o),e.user=t,e.status="authenticated"},K=e=>{e.user=null,e.idToken=null,e.refreshToken=null,e.ref=null,e.status="not-authenticated",localStorage.removeItem("idToken"),localStorage.removeItem("localId"),localStorage.removeItem("refreshToken")};var W=()=>({status:"authenticating",user:null,idToken:null,refreshToken:null});const Y={namespaced:!0,actions:i,getters:s,mutations:u,state:W};var G=Y;const Q=(0,b.MT)({modules:{journal:B,auth:G}});var X=Q;const ee=async(e,t,n)=>{const{ok:r}=await X.dispatch("auth/checkAuthentication");r?n():n({name:"login"})};var te=ee,ne={name:"Home",component:()=>n.e(931).then(n.bind(n,7463))};const re=[{path:"/",...ne},{path:"/daybook",beforeEnter:[te],...v},{path:"/auth",...k}],oe=(0,y.p7)({history:(0,y.r5)(),routes:re});var ae=oe;(0,c.ri)(g).use(X).use(ae).mount("#app")},4207:function(e,t,n){var r=n(6252),o=n(3907);const a=()=>{const e=(0,o.oR)(),t=async t=>{const n=await e.dispatch("auth/createUser",t);return n},n=async t=>{const n=await e.dispatch("auth/signInUser",t);return n},a=async()=>{const t=await e.dispatch("auth/checkAuthentication");return t},i=()=>{e.commit("auth/logout"),e.commit("journal/clearEntries")};return{checkAuthStatus:a,createUser:t,loginUser:n,logout:i,authStatus:(0,r.Fl)((()=>e.getters["auth/currentState"])),userName:(0,r.Fl)((()=>e.getters["auth/userName"]))}};t["Z"]=a}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,n),a.exports}n.m=e,function(){var e=[];n.O=function(t,r,o,a){if(!r){var i=1/0;for(l=0;l<e.length;l++){r=e[l][0],o=e[l][1],a=e[l][2];for(var s=!0,u=0;u<r.length;u++)(!1&a||i>=a)&&Object.keys(n.O).every((function(e){return n.O[e](r[u])}))?r.splice(u--,1):(s=!1,a<i&&(i=a));if(s){e.splice(l--,1);var c=o();void 0!==c&&(t=c)}}return t}a=a||0;for(var l=e.length;l>0&&e[l-1][2]>a;l--)e[l]=e[l-1];e[l]=[r,o,a]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,r){return n.f[r](e,t),t}),[]))}}(),function(){n.u=function(e){return"js/"+({182:"daybook-no-entry",888:"Auth",931:"daybook"}[e]||e)+"."+{131:"b43466e9",182:"e23f0a40",227:"7e6680ae",455:"d9fe917c",703:"e3845455",735:"2dc25280",760:"750a19a8",888:"8383258b",931:"2ff52d3f"}[e]+".js"}}(),function(){n.miniCssF=function(e){return"css/"+({182:"daybook-no-entry",888:"Auth",931:"daybook"}[e]||e)+"."+{182:"bcdec409",227:"2f51e842",703:"a4ea532b",735:"10444688",760:"28652b3b",888:"6bb880b7",931:"d8a556a2"}[e]+".css"}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="journal:";n.l=function(r,o,a,i){if(e[r])e[r].push(o);else{var s,u;if(void 0!==a)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var d=c[l];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+a){s=d;break}}s||(u=!0,s=document.createElement("script"),s.charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+a),s.src=r),e[r]=[o];var f=function(t,n){s.onerror=s.onload=null,clearTimeout(m);var o=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),o&&o.forEach((function(e){return e(n)})),t)return t(n)},m=setTimeout(f.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=f.bind(null,s.onerror),s.onload=f.bind(null,s.onload),u&&document.head.appendChild(s)}}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.p="/vue-Journal-vuex/"}(),function(){var e=function(e,t,n,r){var o=document.createElement("link");o.rel="stylesheet",o.type="text/css";var a=function(a){if(o.onerror=o.onload=null,"load"===a.type)n();else{var i=a&&("load"===a.type?"missing":a.type),s=a&&a.target&&a.target.href||t,u=new Error("Loading CSS chunk "+e+" failed.\n("+s+")");u.code="CSS_CHUNK_LOAD_FAILED",u.type=i,u.request=s,o.parentNode.removeChild(o),r(u)}};return o.onerror=o.onload=a,o.href=t,document.head.appendChild(o),o},t=function(e,t){for(var n=document.getElementsByTagName("link"),r=0;r<n.length;r++){var o=n[r],a=o.getAttribute("data-href")||o.getAttribute("href");if("stylesheet"===o.rel&&(a===e||a===t))return o}var i=document.getElementsByTagName("style");for(r=0;r<i.length;r++){o=i[r],a=o.getAttribute("data-href");if(a===e||a===t)return o}},r=function(r){return new Promise((function(o,a){var i=n.miniCssF(r),s=n.p+i;if(t(i,s))return o();e(r,s,o,a)}))},o={143:0};n.f.miniCss=function(e,t){var n={182:1,227:1,703:1,735:1,760:1,888:1,931:1};o[e]?t.push(o[e]):0!==o[e]&&n[e]&&t.push(o[e]=r(e).then((function(){o[e]=0}),(function(t){throw delete o[e],t})))}}(),function(){var e={143:0};n.f.j=function(t,r){var o=n.o(e,t)?e[t]:void 0;if(0!==o)if(o)r.push(o[2]);else{var a=new Promise((function(n,r){o=e[t]=[n,r]}));r.push(o[2]=a);var i=n.p+n.u(t),s=new Error,u=function(r){if(n.o(e,t)&&(o=e[t],0!==o&&(e[t]=void 0),o)){var a=r&&("load"===r.type?"missing":r.type),i=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+a+": "+i+")",s.name="ChunkLoadError",s.type=a,s.request=i,o[1](s)}};n.l(i,u,"chunk-"+t,t)}},n.O.j=function(t){return 0===e[t]};var t=function(t,r){var o,a,i=r[0],s=r[1],u=r[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(o in s)n.o(s,o)&&(n.m[o]=s[o]);if(u)var l=u(n)}for(t&&t(r);c<i.length;c++)a=i[c],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return n.O(l)},r=self["webpackChunkjournal"]=self["webpackChunkjournal"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=n.O(void 0,[998],(function(){return n(2796)}));r=n.O(r)})();
//# sourceMappingURL=app.75d3d339.js.map